#进销存系统软件体系结构描述文档

## 1. 引言

### 1.1 编制目的

​	本报告详细完成对南京某灯具厂管理系统的概要设计，达到指导详细设计和开发的目的，同时实现和测试人员及用户的沟通。

​	本报告面向开发人员、测试人员及最终用户而编写，是理解系统的导航。

### 1.2 词汇表

|     词汇名称      |     词汇含义     |  备注  |
| :-----------: | :----------: | :--: |
| presentation  |     展示层      |      |
| businesslogic |    业务逻辑层     |      |
|     data      |     数据层      |      |
|      PO       | 持久化存储,是外存的抽象 |      |
|      VO       | 网络传输,是数据包的抽象 |      |

### 1.3 参考资料

## 2. 产品概述

参考之前的管理系统用例文档和需求规格说明文档中对产品的概括和描述。



## 3. 逻辑视角

本系统使用分层体系结构风格，系统被分为presentation，businesslogic，data三层，能够很好的概括高层抽象。presentation包含了GUI页面的实现，交互动作的实现。businesslogic层包含业务逻辑处理的实现，data层负责数据的持久化和访问。分层体系结构的逻辑视角和逻辑设计方案如图所示。

![参照体系结构风格的包图表达逻辑视角](..\img\参照体系结构风格的包图表达逻辑视角.png)

![体系结构逻辑设计方案](..\img\体系结构逻辑设计方案.png)

## 4. 组合视角

### 4.1 开发包图

灯具厂管理系统的最终开发包设计如表所示

| 开发（物理）包                       | 依赖的其他开发包                                 |
| ----------------------------- | :--------------------------------------- |
| mainui                        | categoryui,goodui,viewui,giftui,superviseui, clientui,importui,saleui,accountui,billui,initialAccountui,businessProcessui,   translationSituationui,saleSituationui,promotionui,approveui,userui,vo |
| categoryui                    |                                          |
| categoryblservice             |                                          |
| categorybl                    |                                          |
| categorydataservice           |                                          |
| categorydata                  |                                          |
| goodui                        |                                          |
| goodblservice                 |                                          |
| goodbl                        |                                          |
| gooddataservice               |                                          |
| gooddata                      |                                          |
| viewui                        |                                          |
| viewblservice                 |                                          |
| viewbl                        |                                          |
| viewdataservice               |                                          |
| viewdata                      |                                          |
| giftui                        |                                          |
| giftblservice                 |                                          |
| giftbl                        |                                          |
| giftdataservice               |                                          |
| giftdata                      |                                          |
| superviseui                   |                                          |
| superviseblservice            |                                          |
| supervisebl                   |                                          |
| supervisedataservice          |                                          |
| supervisedata                 |                                          |
| clientui                      |                                          |
| clientblservice               |                                          |
| clientbl                      |                                          |
| clientdataservice             |                                          |
| clientdata                    |                                          |
| importui                      |                                          |
| importblservice               |                                          |
| importbl                      |                                          |
| importdataservice             |                                          |
| importdata                    |                                          |
| saleui                        |                                          |
| saleblservice                 |                                          |
| salebl                        |                                          |
| saledataservice               |                                          |
| saledata                      |                                          |
| accountui                     | accountblservice,界面类库包,vo                |
| accountblservice              |                                          |
| accountbl                     | accountblservice,accountdataservice,po   |
| accountdataservice            | Java RMI,po                              |
| accountdata                   | databaseutility,po,accountdataservice    |
| billui                        | billblservice,界面类库包,vo                   |
| billblservice                 |                                          |
| billbl                        | billblservice,billdataservice,po,promotionbl |
| billdataservice               | Java RMI,po                              |
| billdata                      | databaseutility,po,billdataservice       |
| initialAccountui              | initialAccountblservice,界面类库包,vo         |
| initialAccountblservice       |                                          |
| initialAccountbl              | initialAccountblservice,initialAccountdataservice,po |
| initialAccountdataservice     | Java RMI,po                              |
| initialAccountdata            | databaseutility,po,initialAccountdataservice |
| businessProcessui             | initialAccountblservice,界面类库包            |
| businessProcessblservice      |                                          |
| businessProcessbl             | businessProcessblservice,supervisebl,salebl,billbl,importbl |
| translationSituationui        |                                          |
| translationSituationblservice |                                          |
| translationSituationbl        |                                          |
| saleSituationui               |                                          |
| saleSituationblservice        |                                          |
| saleSituationbl               |                                          |
| promotionui                   |                                          |
| promotionblservice            |                                          |
| promotionbl                   |                                          |
| promotiondataservice          |                                          |
| promotiondata                 |                                          |
| approveui                     |                                          |
| approveblservice              |                                          |
| approvebl                     |                                          |
| approvedataservice            |                                          |
| approvedata                   |                                          |
| userui                        |                                          |
| userblservice                 |                                          |
| userbl                        |                                          |
| userdataservice               |                                          |
| userdata                      |                                          |
| vo                            |                                          |
| po                            |                                          |
| utilitybl                     |                                          |
| 界面类库包                         |                                          |
| Java RMI                      |                                          |
| databaseutility               | JDBC                                     |



### 4.2 运行时进程

（徐）

### 4.3 物理部署

（徐）

## 5. 接口视角

### 5.1模块的职责

- 表 客户端各层的职责

|    层    |           职责           |
| :-----: | :--------------------: |
|  启动模块   |   负责初始化网络通信机制，启动用户界面   |
|  用户界面层  |        客户端用户界面         |
|  业务逻辑层  | 对于用户界面的输入进行响应并进行业务处理逻辑 |
| 客户端网络模块 |  利用Java RMI机制查找RMI服务   |

- 表 服务器端各层的职责

|    层     |             职责              |
| :------: | :-------------------------: |
|   启动模块   |     负责初始化网络通信机制，启动用户界面      |
|   数据层    |       负责数据的持久化及数据访问接口       |
| 服务器端网络模块 | 利用Java RMI机制开启RMI服务，注册RMI服务 |



- 表 层之间调用的接口


|                    接口                    |  服务调用方   |  服务提供方   |
| :--------------------------------------: | :------: | :------: |
| CategoryBLService, GoodBLService, ViewBLService, GiftBLService, SuperviseBLService, ClientBLService, ImportBLService, SaleBLService, AccountBLService, BillBLService, InitialAccountBLService, BusinessProcessBLService, TranslationSituationBLService, SaleSituationBLService, PromotionBLService, ApproveBLService, UserBLService |  客户端展示层  | 客户端业务逻辑层 |
| CategoryDataService, GoodDataService, ViewDataService, GiftDataService, SuperviseDataService, ClientDataService, ImportDataService, SaleDataService, AccountDataService, BillDataService, InitialAccountDataService, BusinessProcessDataService, TranslationSituationDataService, SaleSituationDataService, PromotionDataService, ApproveDataService, UserDataService | 客户端业务逻辑层 | 服务器端数据层  |

（各自参照图9，画了命名成“XX用例层之间调用的接口”将图片保存成png格式存在SEhomework\doc\img下即可）

- 商品分类管理用例层之间调用的接口

  ![商品分类管理用例层之间调用的接口](..\img\商品分类管理用例层之间调用的接口.png)



- 商品管理用例层之间调用的接口

  ![商品管理用例层之间调用的接口](..\img\商品管理用例层之间调用的接口.png)

- 查看库存用例层之间调用的接口

  ![查看库存用例层之间调用的接口](..\img\查看库存用例层之间调用的接口.png)

- 库存赠送用例层之间调用的接口

  ![库存赠送用例层之间调用的接口](..\img\库存赠送用例层之间调用的接口.png)

- 库存监管用例曾之间调用的接口

  ![库存监管用例层之间调用的接口](..\img\库存监管用例层之间调用的接口.png)



- 财务用例层之间调用的接口



- 销售策略用例层之间调用的接口



- 审批用例层之间调用的接口



- 系统管理用例层之间调用的接口



###5.2 用户界面层的分解

根据需求，系统存在 个用户界面：



服务器端和客户端的用户界面设计接口是一致的，只是具体的页面不一样。用户界面类如图所示。

![用户界面类](..\img\用户界面类.png)

####5.2.1 用户界面层模块的职责

如表 所示为用户界面层模块的职责。

- 表 用户界面层

|    模块     |          职责           |
| :-------: | :-------------------: |
| MainFrame | 界面Frame，负责界面的显示和界面的跳转 |

#### 5.2.2 用户界面层莫模块的接口规范

用户界面层模块的接口规范如下。

##### **MainFrame**

##### **语法:** init(args:String[])

##### **前置条件:** 无

##### **后置条件:** 显示Frame以及LoginPanel

用户界面层需要的服务接口如表 所示。

- 表 用户界面层模块需要的服务接口

| 服务名                                 | 服务                |
| :---------------------------------- | :---------------- |
| businesslogicservice.LoginBLService | 登陆界面的业务逻辑接口       |
| businesslogicservice.*BLService     | 每个界面都有一个相应的业务逻辑接口 |

#### 5.2.3 用户界面模块设计原理

用户界面利用Java的Swing和AWT库来实现

###5.3 业务逻辑层的分解 

业务逻辑层包括多个针对界面的业务逻辑处理对象。例如，Commodity对象负责处理库存界面的业务逻辑；Sale对象负责销售界面的业务逻辑；Finance对象负责财务界面的业务逻辑；Promotion对象负责销售策略界面的业务逻辑；Approve对象负责审批界面的业务逻辑；System负责系统管理界面的业务逻辑

![业务逻辑层的设计](..\img\业务逻辑层的设计.png)

#### 5.3.1 业务逻辑层模块的职责

业务逻辑层模块的职责如表所示

（把各自负责的部分填写）

- 表 业务逻辑层模块的职责

|     模块      |          职责          |
| :---------: | :------------------: |
| categorybl  |    负责实现商品界面所需要的服务    |
|   goodbl    |    负责实现商品界面所需要的服务    |
|   viewbl    |   负责实现库存查看界面所需要的服务   |
|   giftbl    |   负责实现赠送库存界面所需要的服务   |
| supervisebl |   负责实现库存监管界面所需要的服务   |
|  clientbl   |        客户信息管理        |
|  importbl   |     负责实现进货/退货的服务     |
|   salebl    | 负责实现销售/退货订单的制定所需要的服务 |
|  financebl  |    负责实现财务界面所需要的服务    |
| promotionbl |                      |
|  approvebl  |                      |
|  systembl   |   负责实现系统管理界面所需要的拂去   |

#### 5.3.2 业务逻辑层模块的接口规范

##### categorybl模块的接口规范

**提供的服务<供接口>**

##### **1. category.addNew**

##### **语法:**public boolean addCategory(String category_name)

##### **前置条件:**

##### **后置条件:**显示添加商品分类成功或者失败

##### **2. category.delete**

##### **语法:**public boolean deleteCategory()

##### **前置条件:**

##### **后置条件:**显示删除商品分类成功或者失败

##### **3. category.rename**

##### **语法:**public boolean renameCategory(String categoryName)

##### **前置条件:**

##### **后置条件:**显示修改商品分类名称成功或者失败

##### **4. category.list**

##### **语法:**public void listCategory(SearchType type)

##### **前置条件:**

##### **后置条件:**

**需要的服务<需接口>** 

|                   服务名                    |         服务          |
| :--------------------------------------: | :-----------------: |
|   DatabaseFacory.getInventoryDatabase    |    得到库存数据库服务的引用     |
| CategoryDataService.insert(CategoryPo po) | 在数据库中插入CategoryPo对象 |

##### goodbl模块的接口规范

**提供的服务<供接口>**

##### **1. Good.addNew**

##### **语法:**public boolean addGood(String goodName)

##### **前置条件:**

##### **后置条件:**显示添加商品成功或者失败

##### **2.Good.delete **

##### **语法:**public boolean deleteGood()

##### **前置条件:**

##### **后置条件:**显示删除商品成功

##### **3.Good.rename **

##### **语法:**public boolean renameGood(String goodName)

##### **前置条件:**

##### **后置条件:**显示修改商品名称成功

##### **4.Good.edit**

##### **语法:**public boolean editGood(EditMessage em)

##### **前置条件:**

##### **后置条件:**显示修改商品信息成功

##### **5.Good.move  **

##### **语法:**public boolean moveGood()

##### **前置条件:**

##### **后置条件:**显示移动商品成功

##### **6.Good.search **

##### **语法:**public List searchGood(SearchType type)

##### **前置条件:**

##### **后置条件:**

**需要的服务<需接口>** 

|                 服务名                 |       服务        |
| :---------------------------------: | :-------------: |
| DatabaseFacory.getInventoryDatabase |  得到库存数据库服务的引用   |
|  GoodDataService.inser(GoodPo po)   | 在数据库中插入GoodPo对象 |
|     CategoryDataService.list()      | 显示所有商品分类的持久化对象  |

##### viewbl模块的接口规范

**提供的服务<供接口>**

##### **1. View.period**

##### **语法:**public List search_by_period(Period period)

##### **前置条件:**

##### **后置条件:**

##### **2. View.check**

##### **语法:**public List check(SearchType type)

##### **前置条件:**

##### **后置条件:**

##### **3. View.ouput_Excel**

##### **语法:**public ResultMessage output_Excel(SearchType type)

##### **前置条件:**

##### **后置条件:**

**需要的服务<需接口>** 

|                   服务名                   |          服务           |
| :-------------------------------------: | :-------------------: |
|   DatabaseFacory.getInventoryDatabase   |     得到库存数据库服务的引用      |
|    ViewDataService.insert(ViewPo po)    |    在数据库中插入ViewPo对象    |
| GoodDataService.search(SearchType type) | 根据SearchType查找多个持久化对象 |

##### giftbl模块的接口规范

**提供的服务<供接口>**

##### **1. Gift.recommend**

##### **语法:**public List gift_recommend()

##### **前置条件:**

##### **后置条件:**

##### **2. Gift.choose**

##### **语法:**public List gift_choose(ChooseType type)

##### **前置条件:**

##### **后置条件:**

##### **3. Gift.commit**

##### **语法:**public ResultMessage gift_commit()

##### **前置条件:**

##### **后置条件:**单据通过，系统打印单据

**需要的服务<需接口>** 

|                   服务名                   |          服务           |
| :-------------------------------------: | :-------------------: |
|   DatabaseFacory.getInventoryDatabase   |     得到库存数据库服务的引用      |
|    GiftDataService.insert(GiftPo po)    |    在数据库中插入GiftPo对象    |
| GoodDataService.search(SearchType type) | 根据SearchType查找多个持久化对象 |

##### supervisebl模块的接口规范

**提供的服务<供接口>**

##### **1. Supervise.overflow**

##### **语法:**public ResultMessage overflow(OverflowData od)

##### **前置条件:**库存管理人员发现库存报溢，记录好库存报溢的数据

##### **后置条件:**生产库存报溢单，提交审批

##### **2. Supervise.loss**

##### **语法:**public ResultMessage loss(LossData ld)

##### **前置条件:库存管理人员发现库存报损，记录好库存报损的数据**

##### **后置条件:**生成库存报损单，提交审批

##### **3. Supervise.alert**

##### **语法:**public ResultMessage alert(CheckNumRequest cnr)

##### **前置条件:**

##### **后置条件:**生成库存报警单，提交审批

**需要的服务<需接口>** 

|                   服务名                   |         服务         |
| :-------------------------------------: | :----------------: |
|   DatabaseFacory.getInventoryDatabase   |    得到库存数据库服务的引用    |
| ReceiptDataService.insert(ReceiptPO po) | 在数据库中插入ReceiptPo对象 |
|    GoodDataService.update(GoodPO po)    |     更新单一持久化对象      |

##### clientbl模块的接口规范

**提供的服务<供接口>**

##### **1. Client.addClient**

##### **语法:**public ResultMessage addClient(ClientVO cvo)

##### **前置条件:**启动一个销售/进货回合，且原表中用户信息不存在

##### **后置条件:**成功添加用户信息

##### **2.Client.deleteClient **

##### **语法:**public ResultMessage deleteClient(int id)

##### **前置条件:**与客户结束交易过程，应收/应付清算完成，且原表中用户信息存在

##### **后置条件:**用户信息成功删除

##### **3.Client.updateClient **

##### **语法:**public ResultMessage updateClient(ClientVO cvo)·1

##### **前置条件:**修改值合法

##### **后置条件:**用户信息修改成功

##### **4.Client.findClient **

##### **语法:**public ClientVO[] updateClient(int id)

##### **前置条件:**用户id存在

##### **后置条件:**返回对应id用户信息

##### importbl模块的接口规范

##### **5.Import.newFrom**

##### **语法:**public ResultMessage newFrom(ImportFormVO ifvo)

##### **前置条件:**用户具有权限

##### **后置条件:**生成新表单

##### **6.Import.findFrom**

##### **语法:**public ImportFormVO[] findFrom(String orderid)

##### **前置条件:**表单信息存在

##### **后置条件**:返回订单信息

##### salebl模块的接口规范

##### **7.Sale.newForm**

##### **语法:**public ResultMessage newFrom(SaleFormVO sfvo)

##### **前置条件:**表单信息存在

##### **后置条件**:返回订单信息

##### **9.Sale.findForm**

##### **语法:**public SaleFormVO[] newFrom(String id)

##### **前置条件:**表单信息存在

##### **后置条件**:返回订单信息

##### **10.Sale.confirm**

##### **语法:**public ResultMessage confirm(String id)

##### **前置条件:**表单存在且未被提交

##### **后置条件**:订单条件设置为待审批

##### **11.Import.confirm**

##### **语法:**public ResultMessage confirm(String id)

##### **前置条件:**表单存在且未被提交

##### **后置条件**:订单条件设置为待审批

##### **12.Sale.cansel**

##### **语法:**public ResultMessage cansel(String id)

##### **前置条件:**表单存在且未被提交

##### **后置条件**:订单条件设置为待审批

##### **13.Import.cansel**

##### **语法:**public ResultMessage confirm(String id)

##### **前置条件:**表单存在且未被提交

##### **后置条件**:删除

**需要的服务<需接口>** 

|            服务名            |         服务         |
| :-----------------------: | :----------------: |
| Database.insertClient(暂定) |     向数据库插入客户信息     |
|   Database.deleteClient   | 从数据库中移除客户相关信息（假移除） |
|   Database.updateClient   |       修改用户信息       |
|    Database.findClient    |       查找用户信息       |
| Database.insertImportForm |       插入进货表单       |
|  Database.insertSaleForm  |       插入销售表单       |
| Database.queryImportForm  |       查询进货单        |
|  Database.querySaleForm   |       查询销售单        |
| Database.updateImportForm |      更新订货单信息       |
|  Database.updateSaleForm  |      更新销售单信息       |

##### 

##### accountbl模块的接口规范

**提供的服务<供接口>**

##### **1. Account.addAccount**

##### **语法:**public ResultMessage addAccount(AccountVO avo)

##### **前置条件:**启动一个新建账户事件

##### **后置条件:**成功添加账户信息

##### **2. Account.delAccount**

##### **语法:**publicb ResultMessage delAccount(String name)

##### **前置条件:**账户name存在

##### **后置条件:**成功删除账户信息

##### **3. Account.findAccount**

##### **语法:**public AccountVO[] findAccount(String name)

##### **前置条件:**查询账户name存在

##### **后置条件:**返回对应name账户信息

##### **4. Account.updateAccount**

##### **语法:**public ResultMessage updateAccount(AccountVO avo)

##### **前置条件:**修改值合法

##### **后置条件:**账户信息修改成功

**需要的服务<需接口>** 

|                   服务名                   |       服务        |
| :-------------------------------------: | :-------------: |
|  AccountDataService.find(String name)   | 根据名称进行查找单一持久化对象 |
| AccountDataService.insert(AccountPo po) |    插入单一持久化对象    |
| AccountDataService.delete(AccountPo po) |    删除单一持久化对象    |
| AccountDataService.update(AccountPo po) |    更新单一持久化对象    |

##### billbl模块的接口规范

##### **提供的服务<供接口>**

##### 1. Bill.newReceipt

##### **语法:**public ResultMessage newReceipt(ReceiptVO rvo)

##### **前置条件:**启动一个生成收款单事件

##### **后置条件:**收款单创建成功

##### **2. Bill.newPayment**

##### **语法:**public ResultMessage newPayment(PaymentVO pvo)

##### **前置条件:**启动一个生成付款单事件

##### **后置条件:**付款单创建成功

##### **3. Bill.newCash**

##### **语法:**public ResultMessage newCash(CashVO cvo)

##### **前置条件:**启动一个生成现金费用单事件

##### **后置条件:**现金费用单创建成功

**4. Bill.changeState**

##### **语法:**public ResultMessage changeState(String id)

##### **前置条件:** 单据Id合法

##### **后置条件:** 将该单据的审批状态改为待审批

**需要的服务<需接口>** 

|                服务名                |    服务     |
| :-------------------------------: | :-------: |
| BillDataService.insert(BillPo po) | 插入单一持久化对象 |
| BillDataService.delete(BillPo po) | 删除单一持久化对象 |
| BillDataService.update(BillPo po) | 更新单一持久化对象 |

##### initialAccountbl的接口规范

**提供的服务<供接口>**

##### **1. InitialAccount.newStage**

##### **语法:**public ResultMessage newStage(InitialAccountVO ivo)

##### **前置条件:** 启动一个期初建账事件

##### **后置条件:** 显示期初建账成功

##### **2. InitialAccount.inquireStage**

##### **语法:**public ResultMessage inquireStage(Datatime datatime)

##### **前置条件:**  时间段合法

##### **后置条件:**  显示该时间段内期初建账信息

**需要的服务<需接口>** 

|                   服务名                    |       服务        |
| :--------------------------------------: | :-------------: |
| InitialAccountDataService.find(String id) | 根据id进行查找单一持久化对象 |
| InitialAccountDataService.insert(InitialAccountPo po) |    插入单一持久化对象    |
| InitialAccountDataService.delete(InitialAccountPo po) |    删除单一持久化对象    |
| InitialAccountDataService.update(InitialAccountPo po) |    更新单一持久化对象    |

**businessProcessbl的接口规范** 

##### **1. BusinessProcess.inquire**

##### **语法:**public ResultMessage inquire(Searchtype type)

##### **前置条件:**查询条件合法

##### **后置条件:**显示符合筛选条件的单据

**2. BusinessProcess.showDetail**

##### **语法:** public FormVo showDetail(String id)

##### **前置条件:**  单据id合法

##### **后置条件:**  显示该单据的详细信息

**3. BusinessProcess.testIdentity**

##### **语法:** public ResultMessage showDetail(Usertype type)

##### **前置条件:**  用户类型合法

##### **后置条件:**  显示该用户是否有权限执行红冲操作

**4. BusinessProcess.copy**

##### **语法:** public FormVo copy(String id)

##### **前置条件:**  单据id合法

##### **后置条件:**  复制该单据提供给用户

**5. BusinessProcess.red**

##### **语法:** public FormVo copy(String id)

##### **前置条件:**  单据id合法

##### **后置条件:**  将该单据的金额数据取负数返回给用户

**需要的服务<需接口>** 

|                  服务名                  |       服务        |
| :-----------------------------------: | :-------------: |
|  SaleDataService.findForm(String id)  | 根据id进行查找单一持久化对象 |
|    BillDataService.find(String id)    | 根据id进行查找单一持久化对象 |
| ImportDataService.findForm(String id) | 根据id进行查找单一持久化对象 |
|                                       |                 |

##### promotionbl模块的接口规范

**提供的服务<供接口>**



**需要的服务<需接口>** 

| 服务名  |  服务  |
| :--: | :--: |
|      |      |

##### approvebl模块的接口规范

**提供的服务<供接口>**



**需要的服务<需接口>** 

| 服务名  |  服务  |
| :--: | :--: |
|      |      |

##### userbl模块的接口规范

**提供的服务<供接口>**

##### **1. User.login**

##### **语法:**public ResultMessage login(long id, String password)

##### **前置条件:** password符合输入规则

##### **后置条件:** 查找是否存在相应的User,根据输入的password返回登陆验证的结果

##### **2. User.new**

##### **语法:**public UserVo new(long id, String password, int level)

##### **前置条件:** id符合规范，password符合输入规则，level符合输入范围

##### **后置条件:** 创建一个用户名为id密码为password等级为level的新用户

##### **3. User.delete**

##### **语法:**public ResultMessage login(long id)

##### **前置条件:** 存在此id的用户

##### **后置条件:** 将此用户标记为“已移除”

**需要的服务<需接口>** 

|                服务名                |       服务        |
| :-------------------------------: | :-------------: |
|  UserDataService.find(String id)  | 根据id进行查找单一持久化对象 |
| UserDataService.insert(UserPo po) |    插入单一持久化对象    |
| UserDataService.delete(UserPo po) |    删除单一持久化对象    |
| UserDataService.update(UserPo po) |    更新单一持久化对象    |

### 5.4 数据层的分解

（此处照着把书上的图画了命名为“XXX数据层模块的描述”保存成png格式存在SEhomework\doc\img下即可）

#### 5.4.1 数据层模块的职责

##### 商品分类管理模块的职责

|                   模块                    |                    职责                    |
| :-------------------------------------: | :--------------------------------------: |
|           CategoryDataService           |     持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务      |
|    CategoryDataServiceExcelFileImpl     | 基于Excel文件的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| CategoryDataServiceSerializableFileImpl | 基于序列化文件的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务  |
|      CategoryDataServiceMySqlImpl       | 基于MySql数据库的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |

##### 商品数据层模块的职责

|                 模块                  |                    职责                    |
| :---------------------------------: | :--------------------------------------: |
|           GoodDataService           |     持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务      |
|    GoodDataServiceExcelFileImpl     | 基于Excel文件的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| GoodDataServiceSerializableFileImpl | 基于序列化文件的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务  |
|      GoodDataServiceMySqlImpl       | 基于MySql数据库的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |

**查看库存数据层模块的职责** 

|                 模块                  |                    职责                    |
| :---------------------------------: | :--------------------------------------: |
|           ViewDataService           |     持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务      |
|    ViewDataServiceExcelFileImpl     | 基于Excel文件的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| ViewDataServiceSerializableFileImpl | 基于序列化文件的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务  |
|      ViewDataServiceMySqlImpl       | 基于MySql数据库的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |

##### 赠品数据层模块的职责

|                 模块                  |                    职责                    |
| :---------------------------------: | :--------------------------------------: |
|           GiftDataService           |     持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务      |
|    GiftDataServiceExcelFileImpl     | 基于Excel文件的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| GiftDataServiceSerializableFileImpl | 基于序列化文件的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务  |
|      GiftDataServiceMySqlImpl       | 基于MySql数据库的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |

**库存监管数据层模块的职责**

|                   模块                   |                    职责                    |
| :------------------------------------: | :--------------------------------------: |
|           ReceiptDataService           |     持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务      |
|    ReceiptDataServiceExcelFileImpl     | 基于Excel文件的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| ReceiptDataServiceSerializableFileImpl | 基于序列化文件的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务  |
|      ReceiptDataServiceMySqlImpl       | 基于MySql数据库的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |

##### 客户数据层模块的职责

|                  模块                   |                    职责                    |
| :-----------------------------------: | :--------------------------------------: |
|           ClientDataService           |     持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务      |
| ClientDataServiceSerializableFileImpl | 基于序列化文件的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务  |
|      ClientDataServiceMysqlImpl       | 基于MySql数据库的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |

##### 进货数据层模块的职责

|                  模块                   |                    职责                    |
| :-----------------------------------: | :--------------------------------------: |
|           ImportDataService           |     持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务      |
| ImportDataServiceSerializableFileImpl | 基于序列化文件的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务  |
|       IportDataServiceMysqlImpl       | 基于MySql数据库的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |

##### 销售数据层模块的职责

|                 模块                  |                    职责                    |
| :---------------------------------: | :--------------------------------------: |
|           SaleDataService           |     持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务      |
| SaleDataServiceSerializableFileImpl | 基于序列化文件的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务  |
|      SaleDataServiceMysqlImpl       | 基于MySql数据库的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |

##### 账户管理数据层模块的职责

|                   模块                   |                    职责                    |
| :------------------------------------: | :--------------------------------------: |
|           AccountDataService           |     持久化数据库的接口，提供集体的载入、集体保存、增、删、改、查服务     |
|    AccountDataServiceExcelFileImpl     | 基于Excel文件的持久化数据库的接口，提供集体的载入、集体保存、增、删、改、查服务 |
| AccountDataServiceSerializableFileImpl | 基于序列化文件的持久化数据库的接口，提供集体的载入、集体保存、增、删、改、查服务 |
|      AccountDataServiceMySqlImpl       | 基于MySql数据库的持久化数据库的接口，提供集体的载入、集体保存、增、删、改、查服务 |

##### 财务管理数据层模块的职责

|               模块                |                    职责                    |
| :-----------------------------: | :--------------------------------------: |
|         BillDataService         |     持久化数据库的接口，提供集体的载入、集体保存、增、删、改、查服务     |
|    BillServiceExcelFileImpl     | 基于Excel文件的持久化数据库的接口，提供集体的载入、集体保存、增、删、改、查服务 |
| BillServiceSerializableFileImpl | 基于序列化文件的持久化数据库的接口，提供集体的载入、集体保存、增、删、改、查服务 |
|      BillServiceMySqlImpl       | 基于MySql数据库的持久化数据库的接口，提供集体的载入、集体保存、增、删、改、查服务 |

##### 期初建账数据层模块的职责

|                    模块                    |                    职责                    |
| :--------------------------------------: | :--------------------------------------: |
|        InitialAccountDataService         |     持久化数据库的接口，提供集体的载入、集体保存、增、删、改、查服务     |
|  InitialAccountDataServiceExcelFileImpl  | 基于Excel文件的持久化数据库的接口，提供集体的载入、集体保存、增、删、改、查服务 |
| InitialAccountDataServiceSerializableFileImpl | 基于序列化文件的持久化数据库的接口，提供集体的载入、集体保存、增、删、改、查服务 |
|    InitialAccountDataServiceMySqlImpl    | 基于MySql数据库的持久化数据库的接口，提供集体的载入、集体保存、增、删、改、查服务 |



##### 销售策略数据层模块的职责

|  模块  |  职责  |
| :--: | :--: |
|      |      |
|      |      |

##### 审批数据层模块的职责

|  模块  |  职责  |
| :--: | :--: |
|      |      |
|      |      |

##### 系统管理数据层模块的职责

|                 模块                  |                    职责                    |
| :---------------------------------: | :--------------------------------------: |
|           UserDataService           |     持久化数据库的接口，提供集体的载入、集体保存、增、删、改、查服务     |
|    UserDataServiceExcelFileImpl     | 基于Excel文件的持久化数据库的接口，提供集体的载入、集体保存、增、删、改、查服务 |
| UserDataServiceSerializableFileImpl | 基于序列化文件的持久化数据库的接口，提供集体的载入、集体保存、增、删、改、查服务 |
|      UserDataServiceMySqlImpl       | 基于MySql数据库的持久化数据库的接口，提供集体的载入、集体保存、增、删、改、查服务 |

#### 5.4.2 数据层模块的接口规范

（此处格式参照5.3.2接口规范示例）

##### 商品分类管理数据层模块的接口规范

**提供的服务<供接口>**

##### SaleDataService.newForm

##### **语法:**public boolean newForm(SaleFormPO po) throws RemoteException;

##### **前置条件:** 同样ID的po在SaleForm中不存在

##### **后置条件:** 在数据库中添加一个po记录



**商品管理数据层模块的接口规范**

##### SaleDataService.newForm

##### **语法:**public boolean newForm(SaleFormPO po) throws RemoteException;

##### **前置条件:** 同样ID的po在SaleForm中不存在

##### **后置条件:** 在数据库中添加一个po记录



**库存查看数据层模块的接口规范**

##### SaleDataService.newForm

##### **语法:**public boolean newForm(SaleFormPO po) throws RemoteException;

##### **前置条件:** 同样ID的po在SaleForm中不存在

##### **后置条件:** 在数据库中添加一个po记录



**库存赠送数据层模块的接口规范** 

##### SaleDataService.newForm

##### **语法:**public boolean newForm(SaleFormPO po) throws RemoteException;

##### **前置条件:** 同样ID的po在SaleForm中不存在

##### **后置条件:** 在数据库中添加一个po记录



**库存监管数据层模块的接口规范** 

##### SaleDataService.newForm

##### **语法:**public boolean newForm(SaleFormPO po) throws RemoteException;

##### **前置条件:** 同样ID的po在SaleForm中不存在

##### **后置条件:** 在数据库中添加一个po记录



##### 销售数据层模块的接口规范

##### 提供的服务<供接口>

##### SaleDataService.newForm

##### **语法:**public boolean newForm(SaleFormPO po) throws RemoteException;

##### **前置条件:** 同样ID的po在SaleForm中不存在

##### **后置条件:** 在数据库中添加一个po记录

##### SaleDataService.findForm

##### **语法:**public SaleFormPO findForm(SaleFormPO po) throws RemoteException;

##### **前置条件:** 同样ID的po在SaleForm中存在

##### **后置条件:** 返回查询结果



##### 进货单管理数据层模块的接口规范

**提供的服务<供接口>**

##### ImportDataService.findForm

##### **语法:**public ImportFormPO newForm(SaleFormPO po) throws RemoteException;

##### **前置条件:** 同样ID的po在ImportForm中存在

##### **后置条件:** 返回查询结果

##### ImportDataService.newForm

##### **语法:**public boolean newForm(ImportFormPO po) throws RemoteException;

##### **前置条件:** 同样ID的po在ImportForm中不存在

##### **后置条件:** 在数据库中添加一个po记录



##### 客户管理数据层模块的接口规范

**提供的服务<供接口>**

##### ClientDataService.newClient

##### **语法:**public boolean newClient(ClientPO po) throws RemoteException;

##### **前置条件:** 同样ID的po在Client中不存在

##### **后置条件:** 在数据库中添加一个po记录



##### 客户管理数据层模块的接口规范

##### ClientDataService.deleteClient

##### **语法:**public boolean newClient(ClientPO po) throws RemoteException;

##### **前置条件:** 数据库中存在同样Client的po

##### **后置条件:** 在数据库中删除一个po记录

##### ClientDataService.findClient

##### **语法:**public ClientPO findClient(ClientPO) throws RemoteException;

##### **前置条件:** 数据库中存在po

##### **后置条件:** 返回查询结果

##### ClientDataService.updateClient

##### **语法:**public boolean updateClient(ClientPO po) throws RemoteException;

##### **前置条件:** 数据库中存在同样ID的po

##### **后置条件:** 在数据库中修改一个po记录

##### 

**账户管理数据层模块的接口规范**

**提供的服务<供接口>**

##### **AccountDataService.insert**

##### **语法:**public void insert(AccountPO po) throws RemoteException;

##### **前置条件:** 同样ID的po在Mapper中不存在

##### **后置条件:** 在数据库中添加一个po记录

##### **AccountDataService.delete**

##### **语法:**public void delete(AccountPO po) throws RemoteException;

##### **前置条件:** 数据库中存在同样ID的po

##### **后置条件:** 在数据库中删除一个po记录

##### **AccountDataService.update**

##### **语法:**public void update(AccountPO po) throws RemoteException;

##### **前置条件:** 数据库中存在同样ID的po

##### **后置条件:** 在数据库中更新一个po记录

##### **AccountDataService.find**

##### **语法:**public AccountPO find(String name) throws RemoteException;

##### **前置条件:** 数据库中存在同样名称的po

##### **后置条件:** 查找返回一个po记录

##### **AccountDataService.init**

##### **语法:**public void init() throws RemoteException

##### **前置条件:** 无

##### **后置条件:** 初始化持久化数据库

##### **AccountDataService.finish**

##### 语法: public void finish() throws RemoteException

##### **前置条件:** 无

##### **后置条件:** 结束初始化持久化数据库的使用



##### 财务管理数据层模块的接口规范

**提供的服务<供接口>**

##### **BillDataService.insert**

##### **语法:**public void insert(BillPO po) throws RemoteException;

##### **前置条件:** 同样ID的po在Mapper中不存在

##### **后置条件:** 在数据库中添加一个po记录

##### **BillDataService.delete**

##### **语法:**public void delete(BillPO po) throws RemoteException;

##### **前置条件:** 数据库中存在同样ID的po

##### **后置条件:** 在数据库中删除一个po记录

##### **BillDataService.update**

##### **语法:**public void update(BillPO po) throws RemoteException;

##### **前置条件:** 数据库中存在同样ID的po

##### **后置条件:** 在数据库中更新一个po记录

##### **BillDataService.find**

##### **语法:**public BillPO find(String id) throws RemoteException;

##### **前置条件:** 数据库中存在同样ID的po

##### **后置条件:** 查找返回一个po记录

##### **BillDataService.init**

##### **语法:**public void init() throws RemoteException

##### **前置条件:** 无

##### **后置条件:** 初始化持久化数据库

##### **BillDataService.finish**

##### 语法: public void finish() throws RemoteException

##### **前置条件:** 无

##### **后置条件:** 结束初始化持久化数据库的使用



##### 期初建账数据层模块的接口规范

**提供的服务<供接口>**

##### **InitialAccountDataService.insert**

##### **语法:**public void insert(InitialAccountPO po) throws RemoteException;

##### **前置条件:** 同样ID的po在Mapper中不存在

##### **后置条件:** 在数据库中添加一个po记录

##### **InitialAccountDataService.delete**

##### **语法:**public void delete(InitialAccountPO po) throws RemoteException;

##### **前置条件:** 数据库中存在同样ID的po

##### **后置条件:** 在数据库中删除一个po记录

##### **InitialAccountDataService.update**

##### **语法:**public void update(InitialAccountPO po) throws RemoteException;

##### **前置条件:** 数据库中存在同样ID的po

##### **后置条件:** 在数据库中更新一个po记录

##### **InitialAccountDataService.find**

##### **语法:**public InitialAccountPO find(String id) throws RemoteException;

##### **前置条件:** 数据库中存在同样ID的po

##### **后置条件:** 查找返回一个po记录

##### **InitialAccountDataService.init**

##### **语法:**public void init() throws RemoteException

##### **前置条件:** 无

##### **后置条件:** 初始化持久化数据库

##### **InitialAccountDataService.finish**

##### 语法: public void finish() throws RemoteException

##### **前置条件:** 无

##### **后置条件:** 结束初始化持久化数据库的使用



##### 销售策略数据层模块的接口规范

**提供的服务<供接口>**



##### 审批数据层模块的接口规范

**提供的服务<供接口>**



##### 系统管理数据层模块的接口规范

**提供的服务<供接口>**



## 6 信息视角

### 6.1 数据持久化对象

此处照书上填写自己部分需要填写的，然后写出定义

示例：

> - UserPO类包含用户的用户名、密码属性
>
> 持久化用户对象UserPO的定义如下：
>
> ~~~
> public class UserPO implements Serializable {
>   ……
>   ……
>   ……
> }
> ~~~
>

- CategoryPo类是包含商品分类的编号属性
- GoodPO类是包含商品的编号、名称、型号、库存数量、进价、零售价、最近进价、最近零售价属性。
- ViewPo类是保存一段时间内库存情况的数据的类，包含出库数量及金额，入库数量及金额，销售数量及金额，进货数量及金额，并且包括库存数量的合计。
- ViewTodayPo类是保存当天内库存情况的数据的类，包含当天各种商品的名称、型号、库存数量、库存均价、批次、批号、出场日期
- GiftPo类是保存赠品的数据的类，包含编号、名称、型号、库存数量、进价、零售价、最近进价、最近零售价属性。
- ReceiptPo类是保存库存库存报溢、报损、报警数据的类，包含包含编号、名称、型号、库存数量、进价、零售价、最近进价、最近零售价属性。

持久化用户对象CategoryPO的定义如下：

```java
public class CategoryPO implements Serializable {
  int id;
  String name;
  
  public CategoryPo(String name){
    this.name = name;
  }
  public String getName(){
    return name;
  }
  public String getId(){
    return id;
  }
}
```

持久化用户对象GoodPO的定义如下：

```java
public class GoodPO implements Serializable {
  int id;
  String name;
  String type;
  int num;
  int pur_price;
  int ret_price;
  int rece_price;
  int rece_ret_price;
  
  public GoodPo(String name, String type, int num, int pur_price, int ret_price, int rece_price, int rece_ret_price){
    this.name = name;
    this.type = type;
    this.num = num;
    this.pur_price = pur_price;
    this.ret_price = rece_price;
    this.rece_ret_price = rece_ret_price;
  }
  public String getName(){
    reutrn name;
  }
  public String getType(){
    return type;
  }
  public int getNum(){
    return num;
  }
  public int getPur_price(){
    return pur_price;
  }
  public int getRet_price(){
    return ret_price;
  }
  public int getRece_ret_price(){
    return rece_ret_price;
  }
}
```

持久化用户对象ViewPO的定义如下：

包含出库数量及金额，入库数量及金额，销售数量及金额，进货数量及金额，并且包括库存数量的合计

```java
public class ViewPO implements Serializable {
  int out_num;
  int out_price;
  int in_num;
  int in_price;
  int sale_num;
  int sale_price;
  
 ;
  
//未完待续
}
```

持久化用户对象ViewTodayPO的定义如下：

```java
public class ViewTodayPO implements Serializable {
  String name;
  String type;
  int num;
  int ava_price;
  int batch；
  int batch_num;
  Date dp;
  
  public ViewTodayPo(String name, String type, int num, int ava_price, int batch, int batch_num, Date dp){
    this.name = name;
    this.type = type;
    this.num = num;
    this.ava_price = ava_price;
    this.batch = batch;
    this.batch_num = batch_num;
    this.dp = dp;
  }
  public String getName(){
    return name;
  }
  public String getType(){
    return type;
  }
  public int getNum(){
    return num;
  }
   public int getAva_price(){
    return ava_price;
  }
   public int get_Batch(){
    return batch;
  }
   public int getBatch_num(){
    return batch_num;
  }
  public Date getDate(){
    return dp;
  }
}
```

持久化用户对象GiftPO的定义如下：

```java
public class GiftPO implements Serializable extends GoodPo {
  //把赠品信息发送给总经理
  public void sendToManager(){
    sendMessage();
  }
  //接受总经理的回复
  public String receiveFromManager(){
    return receiveMessage();
  }
}
```

持久化用户对象ReceiptPO的定义如下：

```java
public class ReceiptPO implements Serializable {
  int id;
  String name;
  int num;
  
  public ReceiptPO(int id, String name, int num){
    this.id = id;
    this.name = name;
    this.num = num;
  }
  public String getName(){
    return name;
  }
  public int getId(){
    return id;
  }
  public int getNum(){
    return num;
  }
  sendMessage();
  receiveMessage();
}
```



- AccountPO类包含账户的名称、余额属性

~~~java
public class AccountPO implements Serializable {
  	String name;
	double balance;
 
  	public AccountPO(String name){
        this.name = name;
      	this.balance = getBalance(this.name);
    }
  
  	public String getname(){
        return name;
    }
  	
      public String getBalance(){
        return balance;
    }
  
}
~~~

- BillPO类包含财务类数据的单据编号、操作员、清单、总额属性

~~~java
public class BillPO implements Serializable {
  	String id;
	String operator;
  	BillList list;
  	double total;
 
  	public BillPO(String id, String operator, BillList list, double total){
        this.id = id;
      	this.operator = operator();
        this.list = list
      	this.total = total;
    }
  
  	public double getTotal(){
        return total;
    }
  	
    public String getId(){
        return id;
    }
  
  	public String getOperator(){
        return operator;
    }  	
  
}
~~~

- InitialAccountPo类包含期初建账数据的商品信息、最近进价和最近售价、客户信息、银行账户信息

~~~java
public class InitialAccountPO implements Serializable {
  	Commodity commodity;
	double importPrice;
  	double exportPrice;
  	Customer customer;
  	Account account;
  
  	public InitialAccountPO(Commodity commodity, double importPrice, double exportPrice, Customer customer, Account account){
        this.commodity = commodity;
      	this.importPrice = importPrice;
        this.exportPrice = exportPrice;
      	this.customer = customer;
      	this.account = account;
    }
  
  	public Commodity getCommodity(){
        return commodity;
    }
  	
    public double getImportPrice(){
        return importPrice;
    }
  	
  	public double getExportPrice(){
        return exportPrice;
    }
  
  	public Customer getCustomer(){
        return customer;
    }  	
  
 	public Customer getAccount(){
        return account;
    } 
  
  
}
~~~



### 6.2 Txt 持久化格式

根据自己部分的需要照书上的例子填写

**Category.xlsx** 

每行分别对应商品的编号、名称。如下所示：

| 编号            | 名称   |
| ------------- | ---- |
| 1234567890123 | 饮品   |

**Good.xlsx** 

每行分别对应商品的编号、名称、型号、库存数量、进价、零售价、最近进价、最近零售价。如下所示：

| 编号            | 名称   | 型号    | 库存数量 | 进价   | 零售价  | 最近进价 | 最近零售价 |
| ------------- | ---- | ----- | ---- | ---- | ---- | ---- | ----- |
| 1234567891234 | 牙膏   | TX183 | 3000 | 25   | 30   | 25   | 33    |

**Receipt.xlsx**

每行分别对应商品的编号、名称、库存数量。如下所示：

| 编号            | 名称   | 库存数量 |
| ------------- | ---- | ---- |
| 1234567891235 | 牙刷   | 500  |

### 6.3 数据库表

数据库中包括Category表、Good表、Gift表、Receipt表